# 图像分类

> 从已知的类别标签集合中给定的输入图片选定一个类别标签

## 训练过程

1. 数据集划分
2. 数据预处理
3. 数据增强
4. 欠拟合和过拟合
   1. 减小算法复杂度
   2. 使用权重正则项
   3. 使用dropout正则化
5. 超参数调整
6. 模型集成

## 分类器设计与学习

![image-20220213185615980](D:\tools\typora\Typora-pic\image-20220213185615980.png)

### 图像表示

1. **像素表示**
2. 全局特征表示（如GIST）
3. 局部特征表示（如SIFT 特征+词袋模型）

### 分类器

1. 近邻分类器
2. 贝叶斯分类器
3. **线性分类器**
4. 支撑向量机分类器
5. **神经网络分类器**
6. 随机森林
7. Adaboost

### 损失函数

1. 0-1损失

2. 多类支撑向量机损失

   ![image-20220213222316662](D:\tools\typora\Typora-pic\image-20220213222316662.png)

   ![image-20220213222338484](D:\tools\typora\Typora-pic\image-20220213222338484.png)

3. 交叉熵损失

4. L1损失

5. L2损失

### 优化算法

1. 一阶方法
   * **梯度下降**
   * **随机梯度下降**
   * **小批量随机梯度下降**
2. 二阶方法
   - **牛顿法**
   - BFGS
   - L-BFGS

# 卷积

## 高斯卷积核

$$
G_\sigma = \frac{1}{2\pi \sigma^2}e^{-\frac{(x^2+y^2)}{2\sigma^2}}
$$



### 生成步骤

1. 确定卷积核尺寸
2. 设置高斯函数的标准差
3. 计算卷积核各个位置权重值
4. 对权重进行归一化

### 参数影响

1. 方差变化

   ![image-20220214175553819](D:\tools\typora\Typora-pic\image-20220214175553819.png)

2. 窗宽变化

   ![image-20220214175635562](D:\tools\typora\Typora-pic\image-20220214175635562.png)

   经验设置：

   ​	当方差为σ时，设置半窗大小为3σ，则窗的边大小为2*3σ+1

### 作用

1. 抑制噪声
2. 实现图像平滑
3. 分解后还可以减少卷积计算的复杂度

## 中值滤波

> 适用于去除椒盐噪声和脉冲噪声

**操作：**

![image-20220214181513991](D:\tools\typora\Typora-pic\image-20220214181513991.png)

## 边缘提取

> 边缘：图像中亮度明显而急剧变化的地方

### 种类

![image-20220214181841687](D:\tools\typora\Typora-pic\image-20220214181841687.png)

### 高斯梯度边缘提取

![image-20220214183842676](D:\tools\typora\Typora-pic\image-20220214183842676.png)

分开操作卷积操作过多，可以进一步改进，利用卷积的==结合率==和==交换率==，一开始首先形成提取模板

![image-20220214184000407](D:\tools\typora\Typora-pic\image-20220214184000407.png)

![image-20220214184050371](D:\tools\typora\Typora-pic\image-20220214184050371.png)

### 非极大抑制

**解决：**

用于解决某些边缘提取后过于粗

**操作：**

![image-20220214184317437](D:\tools\typora\Typora-pic\image-20220214184317437.png)

### Canny边缘检测器

**步骤：**

1. 用高斯一阶偏导核卷积图像
2. 计算每个点的梯度幅值核方向
3. 非极大抑制
   * 将宽的边缘细化至单个像素宽度
4. 连接和阈值（滞后）：
   * 定义两个阈值：低和高
   * 使用高阈值开始边缘曲线，使用低阈值继续边缘曲线（和高阈值相连的）

## 纹理表示

### 种类

1. 规则纹理
2. 随机纹理

### 基于卷积核组的纹理表示方法

![image-20220214190739049](D:\tools\typora\Typora-pic\image-20220214190739049.png)

**思路：**

利用卷积核组提取图像中的纹理基，利用基元的统计信息来表示图像中的纹理

**步骤：**

1. 设计卷积核组
2. 利用卷积核组对图像进行卷积操作获得对应的特征响应图组
3. 利用特征响应图的某种统计信息来表示图像中的纹理

**设计重点：**

1. 卷积核类型（边缘、条形以及点状）
2. 卷积核尺度（3-6个尺度，如方差大小的设置）
3. 卷积核方向（6个角度）

## 上采样

### 反池化操作

1. Nearest Neighbor

   ![image-20220215174315935](D:\tools\typora\Typora-pic\image-20220215174315935.png)

2. Bed of Nails

   ![image-20220215174324925](D:\tools\typora\Typora-pic\image-20220215174324925.png)

3. Index Unpooling

   ![image-20220215174510320](D:\tools\typora\Typora-pic\image-20220215174510320.png)

4. **Transpose Convolution（转置卷积）**

   > 可学习的上采样

   ![image-20220215175644070](D:\tools\typora\Typora-pic\image-20220215175644070.png)

   左边是卷积的矩阵乘法形式，右边是反卷积形式，只需要将卷积核转置一下就可以达成目的

# 语义分割

## 解决思路

### 滑动窗口

![image-20220215173258222](D:\tools\typora\Typora-pic\image-20220215173258222.png)

​	**缺点：**效率低

### 全卷积

![image-20220215173420878](D:\tools\typora\Typora-pic\image-20220215173420878.png)

**问题：**处理过程中一直保持原始分辨率，对于显存的需求会非常庞大

**解决：**

![image-20220215174003727](D:\tools\typora\Typora-pic\image-20220215174003727.png)

# 目标检测

## 单目标

![image-20220215180803982](D:\tools\typora\Typora-pic\image-20220215180803982.png)

分为分类（上分支）和定位（下分支）两块，且分别统计损失值，目标优化总损失值；分类通常是训练好的模型，只需要进行迁移，那么我们就可以优先关注定位问题；最后，再总体训练。

**缺点：**当出现的对象数量不确定时，坐标标注的维度不确定，那么此方法就会失效

## 多目标

![image-20220216215908731](D:\tools\typora\Typora-pic\image-20220216215908731.png)

**操作：**窗口滑动，逐个进行卷积分类

**缺点：**CNN需要对图像中所有可能的区域（不同位置、尺寸、长宽比）进行分类，计算量巨大

**解决：**R-CNN ---> 区域建议(Selective Search)

  1. 找出所有潜在可能包含目标的区域

  2. 运行速度需要相对较快，Selective Search在CPU上仅需要运行几秒钟就可以产生2000个候选区域

     ![image-20220216220946865](D:\tools\typora\Typora-pic\image-20220216220946865.png)

     > 先提取图像，然后对每个图像进行归一化、卷积、分类操作
     >
     > 速度慢

     ![image-20220216221136378](D:\tools\typora\Typora-pic\image-20220216221136378.png)

     > 先对整个区域进行特征提取（卷积），然后从特征图上进行区域选取、裁剪、缩放特征
     >
     > 对R-CNN的改进，速度提升

     

**区域裁剪：Rol Align**

![image-20220216222947485](D:\tools\typora\Typora-pic\image-20220216222947485.png)

> 不规则划分，离目标选取点（x,y）越近的点的贡献越大

**性能分析：**

![image-20220216223228877](D:\tools\typora\Typora-pic\image-20220216223228877.png)

**再次改进：针对区域选取，提出Faster R-CNN**

![image-20220216223635827](D:\tools\typora\Typora-pic\image-20220216223635827.png)

> 因为fast R-CNN主要耗时在候选区域的产生过程，所以提出了用卷积产生候选区域

![image-20220216232021739](D:\tools\typora\Typora-pic\image-20220216232021739.png)

> 目前是两阶段网络，可以将其合并为一阶段网络

![image-20220216232522793](D:\tools\typora\Typora-pic\image-20220216232522793.png)

## 影响因素

![image-20220216232819430](D:\tools\typora\Typora-pic\image-20220216232819430.png)